# 요약

1. TCP와 UDP는 OSI 7 계층들 중 TCP/IP의 전송 계층에서 사용되는 프로토콜이다.
2. TCP는 연속성보다 신뢰성 있는 전송이 중요할 때 사용되는 프로토콜이다.
3. UDP는 TCP보다 빠르고 네트워크 부하가 적다는 장점이 있지만, 신뢰성 있는 데이터 전송을 보장하지는 않는다. 그렇기 때문에 연속성이 중요한 실시간 스트리밍과 같은 서비스에 자주 사용된다.

# 설명

## TCP(Transmission Control Protocol)

**TCP는 연결 지향적 프로토콜**(클라이언트와 서버가 연결된 상태에서 데이터를 주고받는 프로토콜)이다. 신뢰성을 보장하는 연결형 서비스이며, 네트워크에 연결된 컴퓨터에서 실행되는 프로그램 간에 일련의 옥텟(데이터, 메시지, 세그먼트라는 블록 단위)을 안정적으로, 순서대로, 에러 없이 교환할 수 있게 한다.

## TCP의 특징

1. 연결형 서비스로 가상 회선 방식을 제공.
   3-way handshaking 과정을 통해 연결을 설정하고 4-way handshaking 과정을 통해 연결을 해제한다.
2. 흐름 제어(Flow control)
   데이터 처리 속도를 조절하여 수신자의 버퍼 오버플로우를 방지한다.
3. 혼잡 제어(Congestion control)
   네트워크 내의 패킷 수가 과도하게 증가하지 않도록 방지한다.
4. 높은 신뢰성을 보장
   신뢰성이 높은 전송을 하기 때문에 UDP보다 속도가 느리다.
5. 전이중(Full-Duplex), 점대점(Point to Point) 방식
   전이중: 전송이 양방향으로 동시에 일어날 수 있다.
   점대점: 각 연결이 정확히 2개의 종단점을 가지고 있다.

**TCP는 연속성보다 신뢰성 있는 전송이 중요할 때 사용하는 프로토콜**로 UDP보다 속도가 느리며, 파일 전송과 같은 경우에 사용된다.

## TCP의 연결 및 연결 해제 과정

**TCP의 연결 과정(3-way handshake)**

1. 먼저 Open 한 클라이언트가 SYN(synchronize sequence numbers - 연결 확인을 보내는 무작위의 숫자 값)을 보내고 SYN_SENT 상태로 대기한다.
2. 서버는 SYN-RECEIVED 상태로 바꾸고 SYN과 응답 ACK(acknowledgements - Client 혹은 Server로부터 받은 SYN에 1을 더해 SYN을 받았다는 응답)를 보낸다.
3. SYN과 응답 ACK를 받은 클라이언트는 ESTABLISHED 상태로 변경하고 서버에게 응답 ACK를 보낸다.
4. 응답 ACK를 받은 서버는 ESTABLISHED 상태로 변경한다.

| 상태         | 설명                                                  |
| ------------ | ----------------------------------------------------- |
| CLOSED       | 연결 수립을 시작하기 전의 기본 상태(연결 없음)        |
| LISTEN       | 포트가 열린 상태로 연결 요청 대기 중                  |
| SYN-SENT     | SYN을 요청한 상태                                     |
| STN-RECEIVED | SYN 요청을 받고 상대방의 응답을 대기중                |
| ESTABLISHED  | 연결 수립이 완료된 상태, 서로 데이터를 교환할 수 있다 |

**TCP의 연결 해제 과정(4-way handshake)**

1. close를 실행한 클라이언트가 FIN(연결 끊자)을 보내고 FIN-WAIT-1 상태로 대기한다.
2. 서버는 CLOSE-WAIT으로 바꾸고 응답 ACK를 전달함과 동시에 해당 포트에 연결되어 있는 애플리케이션에게 close를 요청한다.
3. ACK를 받은 클라이언트는 상태를 FIN-WAIT-2로 변경한다.
4. close 요청을 받은 서버 애플리케이션은 종료 프로세스를 진행하고 FIN(나도 끊을게)을 클라이언트로 보내 LAST-ACK 상태로 바꾼다.
5. FIN을 받은 클라이언트는 ACK를 서버에 다시 전송하고 TIME-WAIT(먼저 연결을 끊는 소켓, 혹시 모를 전송 실패에 대비하기 위해 존재하는 소켓이며 TIME-WAIT이 없다면, 패킷의 손실이 발생하거나 통신자 간 연결 해제가 제대로 되지 않을 수 있음)으로 상태를 바꾼다.

TIME-WAIT에서 일정 시간이 지나면 CLOSE 된다. ACK를 받은 서버도 포트를 CLOSED로 닫는다.

| 상태        | 설명                                                                                                               |
| ----------- | ------------------------------------------------------------------------------------------------------------------ |
| ESTABLISHED | 연결 수립이 완료된 상태, 서로 데이터를 교환할 수 있다                                                              |
| FIN-WAIT-1  | 자신이 보낸 FIN에 대한 ACK를 기다리거나 상대방의 FIN을 기다린다                                                    |
| FIN-WAIT-2  | 자신이 보낸 FIN에 대한 ACK를 받았고, 상대방의 FIN을 기다린다                                                       |
| CLOSE-WAIT  | 상대방의 FIN(종료 요청)을 받은 상태. 상대방 FIN에 대한 ACK를 보내고 애플리케이션에 종료를 알린다                   |
| LAST-ACK    | CLOSE-WAIT 상태를 처리 후 자신의 FIN 요청을 보낸 후 FIN에 대한 ACK를 기다리는 상태                                 |
| TIME-WAIT   | 모든 FIN에 대한 ACK를 받고 연결 종료가 완료된 상태. 새 연결과 겹치지 않도록 일정 시간 기다린 후 CLOSED로 전이 한다 |
| CLOSED      | 연결 수립을 시작하기 전의 기본 상태(연결 없음)                                                                     |

## UDP(User Datagram Protocol)

**UDP는 비연결형 프로토콜**이다(연결을 위해 할당되는 논리적인 경로가 없고, 각각의 패킷은 다른 경로로 전송되며, 독립적인 관계를 지님).

## UDP의 특징

1. 비연결형 서비스로 데이터그램 방식을 제공한다.
   데이터의 전송 순서가 바뀔 수 있다.
2. 데이터의 수신 여부를 확인하지 않늗나.
   TCP의 3-way-handshake와 같은 과정이 아니다.
3. 신뢰성이 낮다.
   흐름 제어(flow control)가 없어서 제대로 전송되었는지, 오류가 없는지 확인할 수 없다.
4. TCP보다 속도가 빠르다.
5. 1:1 & 1:N & N:N 통신이 가능하다.

UDP는 비연결형 서비스이기 때문에, 연결을 설정하고 해제하는 과정이 존재하지 않고, 서로 다른 경로로 독립적으로 처리하며, 흐름 제어 또는 혼잡 제어와 같은 기능을 처리하지 않기에 TCP보다 속도가 빠르며 네트워크 부하가 적다는 장점이 있지만, 신뢰성 있는 데이터 전송을 보장하지 못한다. UDP는 신뢰성보다는 연속성 있는 전송이 필요할 때 사용하는 프로토콜로 실시간 서비스(streaming)에 자주 사용된다.

| 프로토콜 종류  | TCP                | UDP                       |
| -------------- | ------------------ | ------------------------- |
| 연결 방식      | 연결형 서비스      | 비연결형 서비스           |
| 패킷 교환 방식 | 가상 회선 방식     | 데이터그램 방식           |
| 전송 순서      | 전송 순서 보장     | 전송 순서가 바뀔 수 있음  |
| 수신 여부 확인 | 수신 여부를 확인함 | 수신 여부를 확인하지 않음 |
| 통신 방식      | 1:1 통신           | 1:1 OR 1:N OR N:N 통신    |
| 신뢰성         | 높다               | 낮다                      |
| 속도           | 느리다             | 빠르다                    |

# 예상질문

- TCP와 UDP의 특징 및 차이점에 대해서 설명해주세요.
- 3-way handshake와 4-way handshake에 대해서 설명해주세요.

# Ref

[https://inpa.tistory.com/entry/NW-🌐-아직도-모호한-TCP-UDP-개념-❓-쉽게-이해하자](https://inpa.tistory.com/entry/NW-%F0%9F%8C%90-%EC%95%84%EC%A7%81%EB%8F%84-%EB%AA%A8%ED%98%B8%ED%95%9C-TCP-UDP-%EA%B0%9C%EB%85%90-%E2%9D%93-%EC%89%BD%EA%B2%8C-%EC%9D%B4%ED%95%B4%ED%95%98%EC%9E%90)

https://dev-coco.tistory.com/144
